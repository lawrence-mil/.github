name: ğŸ•’ Waka Readme

on:
  # âœ‹ Manual workflow trigger
  workflow_dispatch:
  schedule:
    # â° Runs every hour at minute 0 (UTC)
    - cron: "0 * * * *"

jobs:
  update-readme:
    name: ğŸ“Š WakaReadme DevMetrics
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“‚ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸš€ Generate WakaTime Stats
        uses: athul/waka-readme@master
        with:
          # ğŸ”‘ API Key (from GitHub Secrets)
          WAKATIME_API_KEY: ${{ secrets.WAKATIME_API_KEY }}

          # ğŸ§­ Display Settings
          SHOW_TITLE: true
          SHOW_TIME: true
          SHOW_TOTAL: true
          LANG_COUNT: 10
          TIME_RANGE: all_time
          SHOW_MASKED_TIME: false

          # ğŸ’» Extra Info Sections
          SHOW_OS: true
          SHOW_PROJECTS: true
          SHOW_EDITORS: true
          SHOW_LANGUAGE_PER_REPO: true
          SHOW_COMMIT: true
          SHOW_DAYS_OF_WEEK: true
          SHOW_LINES_OF_CODE: true

          # ğŸ•°ï¸ Time and Locale
          LOCALE: "en"
          TIMEZONE: "UTC"
          SHOW_UPDATED_DATE: true
          UPDATED_DATE_FORMAT: "%d %b %Y %H:%M UTC"

          # ğŸ“Š Bar and Style
          BLOCKS: â–‘â–’â–“â–ˆ
          BAR_STYLE: "solid"
          SYMBOL_VERSION: 1
          STOP_AT_OTHER: false
          SHOW_LANGUAGE_STAT: true
          SHOW_LANGUAGE: true

          # âœï¸ Commit Settings
          COMMIT_MESSAGE: "ğŸ•’ Updated WakaTime stats [skip ci]"
          TARGET_BRANCH: "main"
          TARGET_PATH: "README.md"

          # ğŸ§© Visual Sections
          SHOW_PROFILE_SECTION: true
          SHOW_CODE_TIME: true
          SHOW_WEEKLY_HOURS: true
          SHOW_SECTION_TITLE: true
          SECTION_NAME: "ğŸ’» My WakaTime Coding Stats"
          LINE_SEPARATOR: " "

          # âš™ï¸ Disable what you donâ€™t want
          SHOW_PROFILE_VIEWS: false
          SHOW_SHORT_INFO: false
          SHOW_LOC_CHART: false
          IGNORED_LANGUAGES: ""

      - name: ğŸ’¾ Commit and Push if README Updated
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          if ! git diff --cached --quiet; then
            git commit -m "ğŸ•’ Updated WakaTime stats [skip ci]"
            git push
          else
            echo "No changes detected â€” skipping commit."
          fi
